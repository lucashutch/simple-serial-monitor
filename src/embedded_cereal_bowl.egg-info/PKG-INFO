Metadata-Version: 2.4
Name: embedded-cereal-bowl
Version: 0.1.0
Summary: A collection of lightweight Python utilities for embedded development
Author-email: Lucas Hutch <lucas@example.com>
License: MIT
Project-URL: Homepage, https://github.com/lucashutch/simple-serial-monitor
Project-URL: Repository, https://github.com/lucashutch/simple-serial-monitor
Project-URL: Issues, https://github.com/lucashutch/simple-serial-monitor/issues
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Programming Language :: Python :: 3.14
Classifier: Topic :: Software Development :: Embedded Systems
Classifier: Topic :: System :: Hardware
Classifier: Topic :: Terminals :: Serial
Classifier: Topic :: Software Development :: Code Generators
Requires-Python: >=3.12
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pyserial>=3.5
Requires-Dist: regex>=2022.0.0
Requires-Dist: colorama>=0.4.4
Provides-Extra: dev
Requires-Dist: pytest>=7.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0; extra == "dev"
Requires-Dist: pytest-mock>=3.10; extra == "dev"
Requires-Dist: ruff>=0.1.0; extra == "dev"
Requires-Dist: mypy>=1.0; extra == "dev"
Requires-Dist: bandit>=1.7; extra == "dev"
Requires-Dist: build>=0.8.0; extra == "dev"
Dynamic: license-file

# **üîß Embedded Cereal Bowl**

A collection of lightweight Python utilities designed to simplify common embedded development and maintenance tasks, including **serial monitoring**, **code formatting**, **line ending checks**, and **timestamp conversion**.

## **üìã Table of Contents**

- [üìú License](#-license)
- [üöÄ Quick Start](#-quick-start)
- [üì¶ Dependencies](#-dependencies)
- [üíª Serial Monitor](#-simple-serial-monitor-monitor)
- [‚ú® Code Formatter](#-universal-code-formatter-formatterpy)
- [üóìÔ∏è Time Converter](#Ô∏è-time-converter-timestamp)
- [‚ö†Ô∏è Line Ending Check](#Ô∏è-crlf-line-ending-check-check_crlfpy)

## **üìú License**

This project is licensed under the **MIT License**.

## **üöÄ Quick Start**

```bash
# Clone the repository
git clone https://github.com/lucashutch/simple-serial-monitor.git
cd simple-serial-monitor

# Install as a package (recommended)
pip install .

# Or install in development mode
pip install -e .

# Start monitoring with console scripts (now available globally)
monitor --send

# Traditional execution still works
./monitor --send
```

## **üì¶ Installation**

### **Option 1: Package Installation (Recommended)**

```bash
# Install from local directory
git clone https://github.com/lucashutch/simple-serial-monitor.git
cd simple-serial-monitor
pip install .

# Install in development mode (for contributors)
pip install -e .

# Install from remote repository
pip install git+https://github.com/lucashutch/simple-serial-monitor.git

# Install from requirements.txt (traditional)
pip install -r requirements.txt
```

### **Option 2: Manual Dependencies**

```bash
pip install pyserial regex colorama
```

### **üõ†Ô∏è Development Setup**

```bash
# Clone and set up development environment
git clone https://github.com/lucashutch/simple-serial-monitor.git
cd simple-serial-monitor

# Create virtual environment (Python 3.12+ required)
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install in development mode with dev dependencies
pip install -e ".[dev]"

# Run tests with coverage
pytest

# Run linting and formatting checks
flake8 src/
black --check src/
mypy src/
bandit -r src/

# Format code automatically
black src/
```

### **üß™ Testing and CI/CD**

This project includes comprehensive **unit and integration tests** with **automated CI/CD** via GitHub Actions:

#### **Testing Coverage**
- **Unit Tests**: All core functionality tested (timestamp conversion, color utilities, code formatting, serial monitoring)
- **Integration Tests**: Mocked serial port operations and CLI workflows
- **Coverage Target**: 80-90% line coverage across all modules
- **Test Framework**: pytest with mocking support

#### **CI/CD Pipeline**
- **Python Versions**: Tests run on Python 3.12, 3.14, and latest
- **Quality Checks**: 
  - Linting with flake8
  - Code formatting with black
  - Type checking with mypy
  - Security scanning with bandit
  - Package building validation
- **Coverage Reporting**: Automated coverage upload to Codecov
- **CLI Testing**: All command-line entry points are validated

#### **Running Tests Locally**

```bash
# Run all tests with coverage
pytest --cov=src --cov-report=term-missing

# Run specific test files
pytest tests/test_timestamp.py
pytest tests/integration/test_serial_integration.py

# Run with verbose output
pytest -v

# Run tests for specific module
pytest tests/test_monitor.py -v

# Run coverage with HTML report
pytest --cov=src --cov-report=html
# Open htmlcov/index.html to view detailed coverage
```

#### **CI/CD Workflow**

The GitHub Actions workflow (`.github/workflows/ci.yml`) automatically:

1. **Triggers** on pushes and PRs to main/develop branches
2. **Tests** across Python 3.12, 3.14, and latest versions
3. **Validates** code quality (linting, formatting, type checking)
4. **Runs** full test suite with coverage reporting
5. **Builds** package to ensure distributability
6. **Uploads** coverage reports and test artifacts

#### **Quality Gates**

- **Tests must pass** across all Python versions
- **Coverage must meet 80% minimum**
- **Code must pass linting and type checking**
- **No high-severity security vulnerabilities**

### **üìã Dependencies**

- **pyserial>=3.5**: Serial communication library
- **regex>=2022.0.0**: Advanced regex for keyword highlighting
- **colorama>=0.4.4**: Cross-platform colored terminal output

**Development Dependencies** (optional):
- **pytest>=7.0**: Testing framework with coverage reporting
- **pytest-mock>=3.10**: Test mocking utilities
- **black>=22.0**: Code formatting
- **flake8>=5.0**: Linting
- **mypy>=1.0**: Static type checking
- **bandit>=1.7**: Security vulnerability scanning
- **build>=0.8.0**: Package building utilities

#### **Python Version Requirements**
- **Minimum**: Python 3.12+ (matches Ubuntu 24.04)
- **Tested**: Python 3.12, 3.14, and latest
- **Recommended**: Use the latest Python 3.12+ release for best compatibility

## **üíª 1. Simple Serial Monitor (monitor)**

A versatile serial monitor for **reading and writing** to serial ports, with features like **interactive sending**, **logging**, **auto-reconnect**, and **highlighting** of specific keywords.

### **‚ú® Key Features**
- **üì° Bidirectional Communication**: Read and send serial data simultaneously
- **üîÑ Auto-Reconnect**: Automatically reconnects when connection is lost
- **üìù Logging**: Save serial data to timestamped log files
- **üé® Keyword Highlighting**: Highlight important words in output
- **‚è∞ Timestamps**: Multiple timestamp formats available
- **üñ•Ô∏è Cross-Platform**: Works on Windows, Linux, and macOS

### **üìñ Usage**

The package supports both **console scripts** and **traditional script execution**:

#### **Console Scripts (After Package Installation)**
```bash
monitor --send                    # Serial monitor with interactive sending
timestamp "2025-10-26T14:10:34Z"  # Time conversion
check-crlf                      # Check line endings
format-code                      # Format source files
```

#### **Traditional Script Execution**
```bash
./monitor --send                 # Original execution style
python timestamp "2025-10-26T14:10:34Z"  # Python script execution
```

#### **Full Command Reference**
```
usage: monitor [-h] [-p PORT] [-b BAUD] [-l] [-lf LOG_FILE] [-ld LOG_DIRECTORY] [-c] [-t {off,epoch,ms,dt}] [--highlight HIGHLIGHT] [--send]

options:
  -h, --help            show this help message and exit
  -p PORT, --port PORT  Specify the serial port to connect to,
                        e.g., ACM0, USB0 (Linux/macOS), or COM3 (Windows)
  -b BAUD, --baud BAUD  Baud rate to set the serial port to (default: 115200)
  -l, --log             Save serial port data to a log file
  -lf LOG_FILE, --log-file LOG_FILE
                        Filename used to save log files. Will appear as date_time_<filename>.txt
  -ld LOG_DIRECTORY, --log-directory LOG_DIRECTORY
                        Folder to save logging file (default: ./logs)
  -c, --clear           Clear terminal before printing
  -t {off,epoch,ms,dt}, --print_time {off,epoch,ms,dt}
                        Print system time on each log line:
                          off   - No timestamp
                          epoch - Unix timestamp with ms (e.g., 1672531200.123)
                          ms    - Milliseconds since epoch
                          dt    - Human-readable datetime (e.g., 2023-01-01 10:00:00.123)
  --highlight HIGHLIGHT
                        Comma-separated list of words to highlight (case-insensitive).
                        Example: --highlight=error,warning,fail
  --send                Enable interactive sending mode - type commands to send to serial device
```

### **üéØ Interactive Sending Mode**

The new `--send` flag enables bidirectional communication, allowing you to send commands to the serial device while monitoring incoming data:

```bash
# Enable interactive sending
./monitor --send

# With specific port and baud rate
./monitor --send --port ACM0 --baud 9600

# With logging and timestamps
./monitor --send --log --print_time dt

# With keyword highlighting
./monitor --send --highlight=error,warning
```

**How it works:**
1. Run monitor with `--send` flag
2. When connected, type commands and press Enter to send
3. Sent data appears in output with timestamps (if enabled)
4. Both sent and received data are logged (if logging enabled)
5. Auto-reconnect works for both sending and receiving

### **üí° Examples**

#### **üì° Basic Monitoring**
```bash
# Monitor with default settings (ACM0/COM3 @ 115200)
./monitor

# Monitor specific port and baud rate
./monitor --port ACM2 --baud 9600
```

#### **üéØ Interactive Sending**
```bash
# Enable interactive sending mode
./monitor --send

# Send commands with logging and timestamps
./monitor --send --log --print_time dt

# Send with keyword highlighting
./monitor --send --highlight=error,warning,fail
```

#### **üìù Logging & Timestamps**
```bash
# Save logs with timestamps
./monitor --log --print_time dt

# Custom log file and directory
./monitor -p ACM0 -b 2000000 -l -lf test_123 -ld /long_test_logs

# Unix timestamp format
./monitor --log --print_time epoch
```

#### **üé® Advanced Features**
```bash
# Clear terminal and highlight keywords
./monitor --clear --highlight=ERROR,WARNING,FAIL

# Combine multiple features
./monitor --send --log --print_time dt --highlight=error --clear
```
## **‚ú® 2. Universal Code Formatter (formatter.py)**

A parallelized script to **automatically format** various source files in a project (C++, CMake, etc.) using external tools like clang-format and cmake-format. It can run in check-only mode to find unformatted files.

### **üõ†Ô∏è Supported Tools**

| Tool | File Extensions | File Names |
| :---- | :---- | :---- |
| **clang-format** | .h, .hpp, .hxx, .hh, .c, .cpp, .cxx, .cc | N/A |
| **cmake-format** | .cmake | CMakeLists.txt |

### **üìñ Usage**
```
usage: formatter.py [-h] [-i DIR [DIR ...]] [-j JOBS] [-v] [--check] [root_dir]

positional arguments:
  root_dir              The root directory to scan (default: current directory)

options:
  -h, --help            show this help message and exit
  --ignore -i DIR [DIR ...]
                        One or more directories to ignore.
                        (e.g., --ignore build third-party)
  -j, --jobs JOBS       The number of concurrent jobs to run.
                        (default: all available CPU cores)
  -v, --verbose         Enable verbose output.
  --check, -c           Run in 'check only' mode. Outputs files requiring changes and
                        the associated required changes
```

### **üí° Examples**
```bash
# Format current directory
python formatter.py

# Check formatting without making changes
python formatter.py --check

# Format specific directory with 4 parallel jobs
python formatter.py /path/to/project --jobs 4

# Ignore specific directories
python formatter.py --ignore build third-party --verbose
```
## **üóìÔ∏è 3. Time Converter (timestamp)**

A command-line tool to convert a Unix timestamp (in seconds or milliseconds) or an ISO 8601 string into **human-readable UTC and local time** ISO 8601 formats.

### **üìñ Usage**
```
usage: timestamp [-h] time_input

positional arguments:
  time_input  Time value (e.g., 1761660634.104 or 2025-10-26T14:10:34.104Z)

options:
  -h, --help  Show this help message and exit
```

### **üí° Examples**
```bash
# Convert Unix timestamp (seconds)
./timestamp 1761660634

# Convert Unix timestamp (milliseconds)
./timestamp 1761660634104

# Convert ISO 8601 string
./timestamp "2025-10-26T14:10:34.104Z"

# Output example:
# UTC:   2025-10-26T14:10:34.104Z
# Local: 2025-10-27T00:10:34.104+10:00 (Example local timezone)
```
usage: timestamp [-h] time_input

positional arguments:
  time_input  Time value (e.g., 1761660634.104 or 2025-10-26T14:10:34.104Z)

options:
  -h, --help  show this help message and exit
```
### **Example**
```
./timestamp 1761660634104
UTC:   2025-10-26T14:10:34.104Z
Local: 2025-10-27T00:10:34.104+10:00 (Example local timezone)
```
## **‚ö†Ô∏è 4. CRLF Line Ending Check (check_crlf.py)**

A simple script to scan a directory for files that incorrectly use **CRLF** (\r\n) line endings instead of the standard **LF** (\n), which can cause issues in cross-platform development.

### **üìñ Usage**
```
usage: check_crlf.py [-h] [--ignore DIR [DIR ...]] [-v] [root_dir]

positional arguments:
  root_dir              The root directory to scan (default: current directory)

options:
  -h, --help            show this help message and exit
  --ignore -i DIR [DIR ...]
                        One or more directories to ignore.
                        (e.g., --ignore build third-party)
  -v, --verbose         Enable verbose output.
```

### **üí° Examples**
```bash
# Check current directory
python check_crlf.py

# Check specific directory
python check_crlf.py /path/to/project

# Ignore specific directories
python check_crlf.py --ignore build third-party --verbose

# Common use case for git repositories
python check_crlf.py --ignore .git build
```

## **ü§ù Contributing**

Contributions are welcome! Feel free to submit issues and pull requests to improve these utilities.

## **üìû Support**

If you encounter any issues or have questions, please open an issue on the [GitHub repository](https://github.com/lucashutch/simple-serial-monitor/issues).

---

**‚≠ê Star this repository if you find these utilities helpful!**
